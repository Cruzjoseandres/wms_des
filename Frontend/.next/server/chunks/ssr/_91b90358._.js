module.exports=[3130,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},77994,a=>{"use strict";var b=a.i(72131);function c(a){let c=b.useRef({value:a,previous:a});return b.useMemo(()=>(c.current.value!==a&&(c.current.previous=c.current.value,c.current.value=a),c.current.previous),[a])}a.s(["usePrevious",()=>c])},84505,a=>{"use strict";let b=(0,a.i(70106).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);a.s(["Download",()=>b],84505)},15618,a=>{"use strict";let b=(0,a.i(70106).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);a.s(["Plus",()=>b],15618)},73320,a=>{"use strict";let b=(0,a.i(70106).default)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);a.s(["Upload",()=>b],73320)},21650,a=>{"use strict";var b=a.i(87924),c=a.i(40695),d=a.i(15618),e=a.i(73320),f=a.i(84505);function g({title:a,description:g,onNew:h,newLabel:i="Nuevo",onImport:j,onExport:k,children:l}){return(0,b.jsxs)("div",{className:"flex flex-col gap-3 sm:gap-4 mb-4 sm:mb-6",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-foreground truncate",children:a}),g&&(0,b.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1 line-clamp-2",children:g})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[l,k&&(0,b.jsxs)(c.Button,{variant:"outline",onClick:k,className:"bg-secondary border-border text-xs sm:text-sm h-8 sm:h-9 px-2 sm:px-3",children:[(0,b.jsx)(f.Download,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-2"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Exportar"})]}),j&&(0,b.jsxs)(c.Button,{variant:"outline",onClick:j,className:"bg-secondary border-border text-xs sm:text-sm h-8 sm:h-9 px-2 sm:px-3",children:[(0,b.jsx)(e.Upload,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-2"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Importar"})]}),h&&(0,b.jsxs)(c.Button,{onClick:h,className:"bg-primary text-primary-foreground hover:bg-primary/90 text-xs sm:text-sm h-8 sm:h-9 px-2 sm:px-3",children:[(0,b.jsx)(d.Plus,{className:"w-3 h-3 sm:w-4 sm:h-4 sm:mr-2"}),(0,b.jsx)("span",{className:"hidden xs:inline",children:i})]})]})]})}a.s(["PageHeader",()=>g])},81560,a=>{"use strict";let b=(0,a.i(70106).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);a.s(["Trash2",()=>b],81560)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},46893,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("textarea",{"data-slot":"textarea",className:(0,c.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),...d})}a.s(["Textarea",()=>d])},67703,a=>{"use strict";var b=a.i(20226),c=a.i(62435);let d="http://localhost:5501/nota-ingreso",e={0:"paletizado",1:"validado",2:"almacenado",3:"anulado"};function f(a){return{id:String(a.id),documento:a.nroDocumento,tipo:"produccion",origen:a.origen||"",fecha:a.fechaIngreso?new Date(a.fechaIngreso).toLocaleDateString("es-ES"):"",items:a.detalles.map(a=>({id:String(a.id),producto:a.codItem,descripcion:a.codItem,cantidad:Number(a.cantidad),lote:a.lote||"",vencimiento:a.fechaVencimiento||""})),estado:e[a.estado]||"paletizado",observaciones:a.observacion||"",usuarioCreacion:a.usuario,almacenId:a.almacen?String(a.almacen.id):""}}let g={async getAll(){let a=await fetch(d,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!a.ok)throw Error("Error al obtener los ingresos");return await a.json()},async getById(a){let b=await fetch(`${d}/${a}`);if(!b.ok)throw Error("Ingreso no encontrado");return await b.json()},async create(a){let b=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).message||"Error al crear el ingreso");return await b.json()}},h=(0,b.create)()((0,c.persist)((a,b)=>({ingresos:[],selectedAlmacenId:null,isLoading:!1,error:null,getIngresos:a=>{let c=b(),d=a||c.selectedAlmacenId;return d?c.ingresos.filter(a=>a.almacenId===d):c.ingresos},addIngreso:b=>{a(a=>({ingresos:[b,...a.ingresos]}))},setIngresos:b=>{a({ingresos:b})},fetchIngresos:async()=>{a({isLoading:!0,error:null});try{let b=(await g.getAll()).map(f);a({ingresos:b,isLoading:!1})}catch(b){a({error:b instanceof Error?b.message:"Error al cargar ingresos",isLoading:!1})}},updateIngresoStatus:(b,c)=>{a(a=>({ingresos:a.ingresos.map(a=>a.id===b?{...a,estado:c}:a)}))},simulateValidation:(b,c)=>{a(a=>({ingresos:a.ingresos.map(a=>a.id===b?{...a,estado:"validado",usuarioValidacion:c}:a)}))},simulateAlmacenaje:(b,c)=>{a(a=>({ingresos:a.ingresos.map(a=>a.id===b?{...a,estado:"almacenado",usuarioAlmacenaje:c}:a)}))},setSelectedAlmacen:b=>{a({selectedAlmacenId:b})},getStatsCounts:a=>{let c=b().ingresos.filter(b=>b.almacenId===a);return{paletizado:c.filter(a=>"paletizado"===a.estado).length,validado:c.filter(a=>"validado"===a.estado).length,almacenado:c.filter(a=>"almacenado"===a.estado).length,anulado:c.filter(a=>"anulado"===a.estado).length}}}),{name:"sgla-ingresos-storage"}));a.s(["useIngresosStore",0,h],67703)},91069,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(96313),f=a.i(21650),g=a.i(3130),h=a.i(40695),i=a.i(5522),j=a.i(17171),k=a.i(87682),l=a.i(21958),m=a.i(46893),n=a.i(67703),o=a.i(15618),p=a.i(81560),q=a.i(87532),r=a.i(96221);let s={"SAP-2024-001":[{id:"i1",producto:"PRD-001",descripcion:"Producto Premium A",cantidad:100,lote:"L2025-100",vencimiento:"2026-06-30"},{id:"i2",producto:"PRD-002",descripcion:"Producto Premium B",cantidad:50,lote:"L2025-101",vencimiento:"2026-12-31"}],"SAP-2024-002":[{id:"i3",producto:"PRD-003",descripcion:"Producto Estándar C",cantidad:200,lote:"L2025-102",vencimiento:"2025-12-15"}]};function t(){let a=(0,d.useRouter)(),t=(0,n.useIngresosStore)(a=>a.addIngreso),u=(0,n.useIngresosStore)(a=>a.selectedAlmacenId),[v,w]=(0,c.useState)("manual"),[x,y]=(0,c.useState)("produccion"),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(""),[D,E]=(0,c.useState)([{id:"1",producto:"",descripcion:"",cantidad:0,lote:"",vencimiento:""}]),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)(!1),N=async()=>{I(!0),await new Promise(a=>setTimeout(a,1500)),s[F]?(K(s[F]),M(!0)):(K([]),M(!1),alert("Documento no encontrado en sistema externo")),I(!1)},O=(a,b,c)=>{E(D.map(d=>d.id===a?{...d,[b]:c}:d))};return(0,b.jsxs)(e.MainLayout,{children:[(0,b.jsx)(f.PageHeader,{title:"Registrar Nuevo Ingreso",description:"Agregue un nuevo ingreso al almacén"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(g.Card,{className:"bg-card border-border",children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)(g.CardTitle,{children:"Información del Ingreso"}),(0,b.jsx)(g.CardDescription,{children:"Datos generales del ingreso"})]}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:"Tipo de Ingreso *"}),(0,b.jsxs)(k.Select,{value:x,onValueChange:a=>y(a),children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-secondary border-border",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"produccion",children:"Producción"}),(0,b.jsx)(k.SelectItem,{value:"traspaso",children:"Traspaso"}),(0,b.jsx)(k.SelectItem,{value:"reingreso",children:"Reingreso"}),(0,b.jsx)(k.SelectItem,{value:"anulacion",children:"Anulación"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:"Origen/Proveedor *"}),(0,b.jsx)(i.Input,{value:z,onChange:a=>A(a.target.value),placeholder:"Ej: Proveedor ABC",className:"bg-secondary border-border"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:"Observaciones"}),(0,b.jsx)(m.Textarea,{value:B,onChange:a=>C(a.target.value),placeholder:"Notas adicionales...",className:"bg-secondary border-border",rows:2})]})]})]}),(0,b.jsxs)(g.Card,{className:"bg-card border-border",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{children:"Detalle de Productos"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)(l.Tabs,{value:v,onValueChange:a=>w(a),children:[(0,b.jsxs)(l.TabsList,{className:"grid w-full grid-cols-2 bg-secondary",children:[(0,b.jsx)(l.TabsTrigger,{value:"manual",children:"Manual (SGLA)"}),(0,b.jsx)(l.TabsTrigger,{value:"externo",children:"Importar Externo (API)"})]}),(0,b.jsxs)(l.TabsContent,{value:"manual",className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)(j.Label,{children:"Productos *"}),(0,b.jsxs)(h.Button,{type:"button",size:"sm",variant:"outline",onClick:()=>{E([...D,{id:String(Date.now()),producto:"",descripcion:"",cantidad:0,lote:"",vencimiento:""}])},className:"bg-secondary border-border",children:[(0,b.jsx)(o.Plus,{className:"w-4 h-4 mr-1"})," Agregar"]})]}),(0,b.jsx)("div",{className:"space-y-3",children:D.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-12 gap-2 items-end p-3 bg-secondary/50 rounded-lg",children:[(0,b.jsxs)("div",{className:"col-span-4 space-y-1",children:[(0,b.jsx)(j.Label,{className:"text-xs",children:"Producto"}),(0,b.jsx)(i.Input,{value:a.producto,onChange:b=>O(a.id,"producto",b.target.value),placeholder:"PRD-001",className:"bg-secondary border-border h-9"})]}),(0,b.jsxs)("div",{className:"col-span-2 space-y-1",children:[(0,b.jsx)(j.Label,{className:"text-xs",children:"Cantidad"}),(0,b.jsx)(i.Input,{type:"number",value:a.cantidad||"",onChange:b=>O(a.id,"cantidad",Number(b.target.value)),className:"bg-secondary border-border h-9"})]}),(0,b.jsxs)("div",{className:"col-span-2 space-y-1",children:[(0,b.jsx)(j.Label,{className:"text-xs",children:"Lote"}),(0,b.jsx)(i.Input,{value:a.lote,onChange:b=>O(a.id,"lote",b.target.value),className:"bg-secondary border-border h-9"})]}),(0,b.jsxs)("div",{className:"col-span-3 space-y-1",children:[(0,b.jsx)(j.Label,{className:"text-xs",children:"Vencimiento"}),(0,b.jsx)(i.Input,{type:"date",value:a.vencimiento,onChange:b=>O(a.id,"vencimiento",b.target.value),className:"bg-secondary border-border h-9"})]}),(0,b.jsx)("div",{className:"col-span-1",children:(0,b.jsx)(h.Button,{type:"button",size:"icon",variant:"ghost",onClick:()=>{var b;return b=a.id,void(D.length>1&&E(D.filter(a=>a.id!==b)))},disabled:1===D.length,className:"h-9 w-9 text-red-400 hover:text-red-300",children:(0,b.jsx)(p.Trash2,{className:"w-4 h-4"})})})]},a.id))})]}),(0,b.jsxs)(l.TabsContent,{value:"externo",className:"space-y-4 mt-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:"Buscar Documento Externo *"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(i.Input,{value:F,onChange:a=>G(a.target.value),placeholder:"Ej: SAP-2024-001",className:"bg-secondary border-border"}),(0,b.jsx)(h.Button,{onClick:N,disabled:!F||H,className:"bg-primary text-primary-foreground",children:H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Loader2,{className:"w-4 h-4 mr-1 animate-spin"}),"Buscando..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.Search,{className:"w-4 h-4 mr-1"}),"Buscar"]})})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Prueba con: SAP-2024-001 o SAP-2024-002"})]}),L&&(0,b.jsxs)("div",{className:"p-4 bg-green-600/20 border border-green-600/50 rounded-lg",children:[(0,b.jsx)("p",{className:"font-medium text-green-400",children:"Documento encontrado"}),(0,b.jsxs)("p",{className:"text-sm text-green-300",children:[J.length," productos cargados"]})]}),J.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.Label,{children:"Productos del Documento"}),(0,b.jsx)("div",{className:"space-y-2",children:J.map(a=>(0,b.jsxs)("div",{className:"p-3 bg-secondary/50 rounded-lg space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:a.producto}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Cantidad: ",a.cantidad]})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.descripcion}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Lote: ",a.lote," | Vencimiento: ",a.vencimiento]})]},a.id))})]})]})]})})]})]}),(0,b.jsx)("div",{children:(0,b.jsxs)(g.Card,{className:"bg-card border-border sticky top-24",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{className:"text-lg",children:"Resumen"})}),(0,b.jsxs)(g.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Tipo"}),(0,b.jsx)("span",{className:"font-medium",children:"produccion"===x?"Producción":"traspaso"===x?"Traspaso":"reingreso"===x?"Reingreso":"Anulación"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Origen"}),(0,b.jsx)("span",{className:"font-medium",children:z||"—"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Productos"}),(0,b.jsx)("span",{className:"font-medium",children:"externo"===v?J.length:D.length})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Cantidad Total"}),(0,b.jsx)("span",{className:"font-medium",children:("externo"===v?J:D).reduce((a,b)=>a+b.cantidad,0)})]})]}),(0,b.jsxs)("div",{className:"bg-primary/10 border border-primary/20 rounded p-3",children:[(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Estado inicial"}),(0,b.jsx)("p",{className:"font-medium text-primary",children:"PALETIZADO"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Button,{onClick:()=>{let b="externo"===v?J:D;z&&0!==b.length?(t({id:String(Date.now()),documento:`ING-2025-${String(Date.now()).slice(-4)}`,tipo:x,origen:z,fecha:new Date().toISOString().split("T")[0],items:b,estado:"paletizado",observaciones:B,usuarioCreacion:"Fernando",almacenId:u||"001"}),a.push("/ingresos")):alert("Complete los campos requeridos")},className:"w-full bg-primary text-primary-foreground",children:"Confirmar Recepción"}),(0,b.jsx)(h.Button,{variant:"outline",onClick:()=>a.back(),className:"w-full bg-secondary border-border",children:"Cancelar"})]})]})]})})]})]})}a.s(["default",()=>t])}];

//# sourceMappingURL=_91b90358._.js.map