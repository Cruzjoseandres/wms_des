module.exports=[544,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(96313),e=a.i(21650),f=a.i(40695),g=a.i(3130),h=a.i(54161),i=a.i(5522),j=a.i(17171),k=a.i(87682),l=a.i(65733),m=a.i(88237),n=a.i(15618),o=a.i(25015),p=a.i(48124),q=a.i(4720),r=a.i(41675),s=a.i(24987),t=a.i(73570),u=a.i(16201),v=a.i(41710),w=a.i(96221),x=a.i(75824);let y={async getAll(){let a=await fetch(x.API_ENDPOINTS.inventario,{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!a.ok)throw Error("Error al obtener los inventarios");return await a.json()},async create(a){let b=await fetch(x.API_ENDPOINTS.inventario,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).message||"Error al crear el inventario");return await b.json()},async update(a,b){let c=await fetch(`${x.API_ENDPOINTS.inventario}/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).message||"Error al actualizar el inventario");return await c.json()}};var z=a.i(23292);let A=[{id:"1",codigo:"INV-2025-001",tipo:"General",estado:"Abierto",fechaApertura:"2025-01-08",almacen:"PT9 NUEVO CEDIS",itemsContados:450,itemsTotales:1765,diferencias:0,responsable:"Carlos Mendoza"},{id:"2",codigo:"INV-2025-002",tipo:"Parcial",estado:"En Proceso",fechaApertura:"2025-01-05",almacen:"PT9 NUEVO CEDIS",bodega:"Bodega A",itemsContados:280,itemsTotales:320,diferencias:5,responsable:"María López"},{id:"3",codigo:"INV-2024-089",tipo:"General",estado:"Cerrado",fechaApertura:"2024-12-15",fechaCierre:"2024-12-18",almacen:"PT9 NUEVO CEDIS",itemsContados:1720,itemsTotales:1720,diferencias:12,responsable:"Juan Pérez"}];function B(){let[a,x]=(0,c.useState)([]),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)("all"),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)(!0),[P,Q]=(0,c.useState)({tipo:"General",almacenId:"",bodega:"",responsable:""}),R=[{id:1,codigo:"PROD-001",descripcion:"Producto Ejemplo 1",stock:100,precio:10,categoria:"General"}],S=[{id:1,codigo:"WH-01",descripcion:"PT9 NUEVO CEDIS",ubicacion:"Central"}],T=async()=>{await new Promise(a=>setTimeout(a,500)),x(A)};(0,c.useEffect)(()=>{(async()=>{O(!0);try{K(R),M(S),await T()}catch(a){console.error(a),z.toast.error("Error al cargar datos del sistema")}finally{O(!1)}})()},[]);let U=a.filter(a=>"Abierto"===a.estado).length,V=a.filter(a=>"En Proceso"===a.estado).length,W=a.filter(a=>"Cerrado"===a.estado).length,X=a.filter(a=>"all"===H||a.estado===H),Y=async()=>{L.find(a=>String(a.id)===P.almacenId);let b="General"===P.tipo?J.length:Math.max(1,Math.floor(.2*J.length));try{await y.create({codigo:`INV-2025-${String(a.length+1).padStart(3,"0")}`,tipo:P.tipo,fechaApertura:new Date().toISOString().split("T")[0],almacenId:Number(P.almacenId),bodega:"Parcial"===P.tipo?P.bodega:void 0,responsable:P.responsable,itemsTotales:b}),await T(),C(!1),Q({tipo:"General",almacenId:"",bodega:"",responsable:""}),z.toast.success("Inventario creado correctamente")}catch(a){z.toast.error("Error al crear inventario")}},Z=async a=>{try{await y.update(Number(a.id),{estado:"Cerrado",fechaCierre:new Date().toISOString().split("T")[0]}),z.toast.success("Inventario cerrado"),T()}catch(a){z.toast.error("Error al cerrar inventario")}},$=async a=>{try{await y.update(Number(a.id),{estado:"En Proceso"}),z.toast.success("Conteo iniciado"),T()}catch(a){z.toast.error("Error al iniciar conteo")}},_=a=>{switch(a){case"Abierto":return(0,b.jsx)(h.Badge,{className:"bg-blue-600 text-white",children:"Abierto"});case"En Proceso":return(0,b.jsx)(h.Badge,{className:"bg-amber-500 text-white",children:"En Proceso"});case"Cerrado":return(0,b.jsx)(h.Badge,{className:"bg-green-600 text-white",children:"Cerrado"});default:return(0,b.jsx)(h.Badge,{children:a})}},aa=(a,b)=>Math.round(a/b*100);return(0,b.jsx)(d.MainLayout,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(e.PageHeader,{title:"Gestión de Inventarios",description:"Apertura, seguimiento y cierre de inventarios",actions:(0,b.jsxs)(f.Button,{onClick:()=>C(!0),className:"bg-orange-500 hover:bg-orange-600",disabled:N,children:[N?(0,b.jsx)(w.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}):(0,b.jsx)(n.Plus,{className:"h-4 w-4 mr-2"}),"Nuevo Inventario"]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsx)(g.Card,{className:"bg-blue-600 border-0",children:(0,b.jsx)(g.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-blue-100 text-sm",children:"Abiertos"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-white",children:U})]}),(0,b.jsx)(v.Clock,{className:"h-10 w-10 text-blue-200"})]})})}),(0,b.jsx)(g.Card,{className:"bg-amber-500 border-0",children:(0,b.jsx)(g.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-amber-100 text-sm",children:"En Proceso"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-white",children:V})]}),(0,b.jsx)(o.Play,{className:"h-10 w-10 text-amber-200"})]})})}),(0,b.jsx)(g.Card,{className:"bg-green-600 border-0",children:(0,b.jsx)(g.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-green-100 text-sm",children:"Cerrados"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-white",children:W})]}),(0,b.jsx)(u.CheckCircle,{className:"h-10 w-10 text-green-200"})]})})}),(0,b.jsx)(g.Card,{className:"bg-red-600 border-0",children:(0,b.jsx)(g.CardContent,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-red-100 text-sm",children:"Con Diferencias"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-white",children:a.filter(a=>a.diferencias>0).length})]}),(0,b.jsx)(t.AlertTriangle,{className:"h-10 w-10 text-red-200"})]})})})]}),(0,b.jsx)(g.Card,{className:"bg-card border-border",children:(0,b.jsx)(g.CardContent,{className:"p-4",children:(0,b.jsx)("div",{className:"flex flex-wrap gap-4 items-end",children:(0,b.jsxs)("div",{className:"w-48",children:[(0,b.jsx)(j.Label,{className:"text-muted-foreground",children:"Estado"}),(0,b.jsxs)(k.Select,{value:H,onValueChange:I,children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-background border-border",children:(0,b.jsx)(k.SelectValue,{placeholder:"Todos los estados"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"all",children:"Todos"}),(0,b.jsx)(k.SelectItem,{value:"Abierto",children:"Abierto"}),(0,b.jsx)(k.SelectItem,{value:"En Proceso",children:"En Proceso"}),(0,b.jsx)(k.SelectItem,{value:"Cerrado",children:"Cerrado"})]})]})]})})})}),(0,b.jsxs)(g.Card,{className:"bg-card border-border",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsx)(g.CardTitle,{className:"text-foreground",children:"Inventarios"})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)(m.Table,{children:[(0,b.jsx)(m.TableHeader,{children:(0,b.jsxs)(m.TableRow,{className:"border-border",children:[(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Código"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Tipo"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Almacén/Bodega"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Fecha Apertura"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Progreso"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Diferencias"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Estado"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Responsable"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Acciones"})]})}),(0,b.jsx)(m.TableBody,{children:X.map(a=>(0,b.jsxs)(m.TableRow,{className:"border-border",children:[(0,b.jsx)(m.TableCell,{className:"text-foreground font-medium",children:a.codigo}),(0,b.jsx)(m.TableCell,{children:(0,b.jsx)(h.Badge,{variant:"outline",className:"General"===a.tipo?"border-purple-500 text-purple-500":"border-cyan-500 text-cyan-500",children:a.tipo})}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(s.MapPin,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:a.almacen}),a.bodega&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.bodega})]})]})}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Calendar,{className:"h-4 w-4 text-muted-foreground"}),a.fechaApertura]})}),(0,b.jsx)(m.TableCell,{children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,b.jsxs)("span",{className:"text-muted-foreground",children:[a.itemsContados,"/",a.itemsTotales]}),(0,b.jsxs)("span",{className:"text-foreground",children:[aa(a.itemsContados,a.itemsTotales),"%"]})]}),(0,b.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-orange-500 h-2 rounded-full transition-all",style:{width:`${aa(a.itemsContados,a.itemsTotales)}%`}})})]})}),(0,b.jsx)(m.TableCell,{children:a.diferencias>0?(0,b.jsx)("span",{className:"text-red-500 font-medium",children:a.diferencias}):(0,b.jsx)("span",{className:"text-green-500",children:"0"})}),(0,b.jsx)(m.TableCell,{children:_(a.estado)}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:a.responsable}),(0,b.jsx)(m.TableCell,{children:(0,b.jsxs)("div",{className:"flex gap-2",children:["Abierto"===a.estado&&(0,b.jsxs)(f.Button,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",onClick:()=>$(a),children:[(0,b.jsx)(o.Play,{className:"h-3 w-3 mr-1"}),"Iniciar"]}),"En Proceso"===a.estado&&(0,b.jsxs)(f.Button,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>Z(a),children:[(0,b.jsx)(p.Square,{className:"h-3 w-3 mr-1"}),"Cerrar"]}),(0,b.jsxs)(f.Button,{size:"sm",variant:"outline",onClick:()=>{G(a),E(!0)},children:[(0,b.jsx)(q.FileText,{className:"h-3 w-3 mr-1"}),"Reporte"]})]})})]},a.id))})]})})]}),(0,b.jsx)(l.Dialog,{open:B,onOpenChange:C,children:(0,b.jsxs)(l.DialogContent,{className:"bg-card border-border",children:[(0,b.jsx)(l.DialogHeader,{children:(0,b.jsx)(l.DialogTitle,{className:"text-foreground",children:"Nuevo Inventario"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{className:"text-muted-foreground",children:"Tipo de Inventario"}),(0,b.jsxs)(k.Select,{value:P.tipo,onValueChange:a=>Q({...P,tipo:a}),children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-background border-border",children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"General",children:"General (Todo el almacén)"}),(0,b.jsx)(k.SelectItem,{value:"Parcial",children:"Parcial (Por bodega/zona)"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{className:"text-muted-foreground",children:"Almacén"}),(0,b.jsxs)(k.Select,{value:P.almacenId,onValueChange:a=>Q({...P,almacenId:a}),children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-background border-border",children:(0,b.jsx)(k.SelectValue,{placeholder:"Seleccionar almacén"})}),(0,b.jsx)(k.SelectContent,{children:L.map(a=>(0,b.jsxs)(k.SelectItem,{value:String(a.id),children:[a.codigo," - ",a.descripcion]},a.id))})]}),0===L.length&&(0,b.jsx)("p",{className:"text-xs text-amber-500 mt-1",children:"No hay almacenes cargados"})]}),"Parcial"===P.tipo&&(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{className:"text-muted-foreground",children:"Bodega/Zona"}),(0,b.jsxs)(k.Select,{value:P.bodega,onValueChange:a=>Q({...P,bodega:a}),children:[(0,b.jsx)(k.SelectTrigger,{className:"bg-background border-border",children:(0,b.jsx)(k.SelectValue,{placeholder:"Seleccionar bodega"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"Bodega A",children:"Bodega A"}),(0,b.jsx)(k.SelectItem,{value:"Bodega B",children:"Bodega B"}),(0,b.jsx)(k.SelectItem,{value:"Bodega C",children:"Bodega C"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.Label,{className:"text-muted-foreground",children:"Responsable"}),(0,b.jsx)(i.Input,{value:P.responsable,onChange:a=>Q({...P,responsable:a.target.value}),placeholder:"Nombre del responsable",className:"bg-background border-border"})]})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>C(!1),children:"Cancelar"}),(0,b.jsx)(f.Button,{className:"bg-orange-500 hover:bg-orange-600",onClick:Y,disabled:!P.almacenId||!P.responsable,children:"Crear Inventario"})]})]})}),(0,b.jsx)(l.Dialog,{open:D,onOpenChange:E,children:(0,b.jsxs)(l.DialogContent,{className:"bg-card border-border max-w-2xl",children:[(0,b.jsx)(l.DialogHeader,{children:(0,b.jsxs)(l.DialogTitle,{className:"text-foreground",children:["Reporte de Inventario - ",F?.codigo]})}),F&&(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tipo"}),(0,b.jsx)("p",{className:"text-lg font-medium text-foreground",children:F.tipo})]}),(0,b.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Estado"}),(0,b.jsx)("p",{className:"text-lg font-medium",children:_(F.estado)})]}),(0,b.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Items Contados"}),(0,b.jsxs)("p",{className:"text-lg font-medium text-foreground",children:[F.itemsContados," / ",F.itemsTotales]})]}),(0,b.jsxs)("div",{className:"bg-muted/50 p-4 rounded-lg",children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Diferencias"}),(0,b.jsx)("p",{className:`text-lg font-medium ${F.diferencias>0?"text-red-500":"text-green-500"}`,children:F.diferencias})]})]}),F.diferencias>0&&(0,b.jsxs)(g.Card,{className:"bg-red-500/10 border-red-500/20",children:[(0,b.jsx)(g.CardHeader,{children:(0,b.jsxs)(g.CardTitle,{className:"text-red-500 text-sm flex items-center gap-2",children:[(0,b.jsx)(t.AlertTriangle,{className:"h-4 w-4"}),"Diferencias Encontradas"]})}),(0,b.jsx)(g.CardContent,{children:(0,b.jsxs)(m.Table,{children:[(0,b.jsx)(m.TableHeader,{children:(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Producto"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Sistema"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Físico"}),(0,b.jsx)(m.TableHead,{className:"text-muted-foreground",children:"Diferencia"})]})}),(0,b.jsxs)(m.TableBody,{children:[(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableCell,{className:"text-foreground",children:"PROD-001"}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:"150"}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:"147"}),(0,b.jsx)(m.TableCell,{className:"text-red-500",children:"-3"})]}),(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableCell,{className:"text-foreground",children:"PROD-045"}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:"80"}),(0,b.jsx)(m.TableCell,{className:"text-foreground",children:"82"}),(0,b.jsx)(m.TableCell,{className:"text-green-500",children:"+2"})]})]})]})})]})]}),(0,b.jsxs)(l.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>E(!1),children:"Cerrar"}),(0,b.jsxs)(f.Button,{className:"bg-orange-500 hover:bg-orange-600",children:[(0,b.jsx)(q.FileText,{className:"h-4 w-4 mr-2"}),"Exportar PDF"]})]})]})})]})})}a.s(["default",()=>B],544)}];

//# sourceMappingURL=app_inventario_gestion_page_tsx_cf2e711a._.js.map